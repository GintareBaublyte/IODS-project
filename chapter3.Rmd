#Logistic Regression

##The Data

*The dataset is imported.*
```{r, echo=TRUE} 
alc <- read.table("alc.txt", header = T, sep = ";")

```
There are **35** variables in the dataset with **382** observations in total. Among the variables there is some basic demographic data (e.g. sex, age, family size, etc.), some variables are related to school, some to personal life and relationships. G1, G2 and G3 are grades for the first period, second period and final grade accordingly.  
  
The variables called *alc_use* shows the average weekly alcohol consumption while the variable *high_use* indicated average weekly alcohol consumption higher than 2.


```{r, echo=TRUE} 
colnames(alc)

str(alc)


```

I will analyse the relationships between alcohol consumption and 4 of the following variables:  
1. weekly study time (*studytime*)  
2. romantic relationship status (*romantic*)  
3. quality of family relationships (*famrel*)  
4. age (*age*)  

##Testing hypothesis  

Four hypothesis related to the alcohol consumption and the chosen variables:  
**H1**: Students who study longer during the week, consume less alcohol compared to those who study less.  
**H2**: Those in a romantic relationship consume less alcohol compared to those who are not in a romantic relationship.  
**H3**: Those who have better family relationships consume less alcohol than those in poor family relationships.  
**H4**: Younger students consume more alcohol than older students.  


```{r} 
library(ggplot2)
library(dplyr)

```
###First hypothesis  

The relationship between alcohol consumption and weekly study time will be analysed.  
  
In the survey students had to choose how many hours a week they study. The options were:  
1 - less than 2 hours  
2 - from 2 to 5 hours  
3 - from 5 to 10 hours  
4 - more than 10 hours  
  
Here we see that on average students study from 2 to 5 hours, because the mean of the answers is around 2 which is attributed to 2-10 hours as explained above. In addition to that, all the answers were ranging from 1 and 4.


```{r, echo=TRUE} 
summary(alc$studytime)

```

To visualize the data a boxplot will be drawn.  
  
This grapgh shows that 50% of students who do not consume high amounts of alcohol study from 2 to 10 hours a week. 50% of students who consume high amounts of alcohol study less than 2 hours a week.


```{r, echo=TRUE} 
g1 <- ggplot(alc, aes(x = high_use, y= studytime))
g1 + geom_boxplot(aes()) + xlab("High alcohol consuption") + ylab("Weekly study time") + ggtitle("Student weekly study time by alcohol consumption")

```

The table below shows the frequencies. It is clear that most of the students (195) study from 2 to 5 hours a week, while least students study more than 10 hours. Additionally, overall most students do not consume high amounts of alcohol weekly irrespectivelly of how much they study. However, it is obvious that students that study less than 2 hours a week have a higher proportion of students that consume more alcohol compared to all the other students. 

```{r, echo=TRUE}
table_studytime <- xtabs(~high_use+studytime, data=alc)
ftable(table_studytime)
```
Similar results are visible in the grapgh below.

```{r, echo=TRUE}
counts_studytime <- table(alc$high_use, alc$studytime)
barplot(counts_studytime, main="Study time vs high use",
  xlab="Study time", col=c("darkblue","red"),
 	legend = rownames(counts_studytime), beside=TRUE)
```

**H1**: Students who study longer during the week, consume less alcohol compared to those who study less. 

**H1 is confimed.**  
  
###Second Hypothesis  
  
The relationship between alcohol consumption and relationship status will be analysed. 
  
In the survey students had to choose wheather they are in a romantic relationship (YES) or they aren't (NO).  
  
We can see that more than 2 times more students are not in a romantic relationship.

```{r, echo=TRUE} 
summary(alc$romantic)

```

Frequencies table shows that overall students use less alcohol independent on their relationship status.  

```{r, echo=TRUE}
table_romantic <- xtabs(~high_use+romantic, data=alc)
ftable(table_romantic)
```
The proportions are as follows:  
`r 180/(180+81)*100`% of students who aren't in a romantic relationship consume low amounts of alcohol, while the rest consumes high amounts.
`r 88/(88+33)*100`% of students who are in a romantic relationship consume low amounts of alcohol, while the rest of those students consume high amounts.  

This shows that higher proportion of students who are in a relationship status also do not drink high amounts of alcohol compared to those who are single.

The grapgh below also shows that there are significantly more people that aren't in a romantic relationship, but the proportions of those who consume alcohol on a high level are quite close for both relationship status. 

```{r, echo=TRUE}
counts_romantic <- table(alc$high_use, alc$romantic)
barplot(counts_romantic, main="Relationship status vs high use",
  xlab="Relationship status", col=c("darkblue","red"),
 	legend = rownames(counts_romantic))
```


**H2**: Those in a romantic relationship consume less alcohol compared to those who are not in a romantic relationship.

**H2 is confirmed.**  


###Third hypothesis  
  
The relationship between alcohol consumption and quality of their family relationship will be analysed.  

In the survey students had to choose wheather what is the quality of their family relationship. The possible answer options ranged from 1 - very bad to 5 - excellent.  
  
On average students indicated that their relationship with the family are good (3.937), however, the whole range of answers was used in answering this question.

```{r, echo=TRUE} 
summary(alc$famrel)

```

Frequencies table also shows that most of the students are in a good relationship with their family. Only 8 students indicated that the relationship was very poor.   

```{r, echo=TRUE}
table_famrel <- xtabs(~high_use+famrel, data=alc)
ftable(table_famrel)
```

The box plot shows that 50% of students who do not consume high amounts of alcohol have good or excellent relationships with their family, whereas, 50% of students who consume high amounts of alcohol have average or good relationships. Another interesting thing is that among the students who do not consume high amounts of alcohol the answers ranged from average to excellent, which outliers for 2 other options. In contast, the answers among the students who consume high amounts of alcohol, the answers ranged from poor to excellent, with an outlier in very poor. Thus, it can be stated that overall students who do not consume high amounts of alcohol are more in better relationships with their families.


```{r, echo=TRUE} 
g2 <- ggplot(alc, aes(x = high_use, y= famrel))
g2 + geom_boxplot(aes()) + xlab("High alcohol consuption") + ylab("Quality of family relationship") + ggtitle("Student quality of family relationship by alcohol consumption")

```

**H3**: Those who have better family relationships consume less alcohol than those in poor family relationships.

**H3 is confirmed.**  

###Fourth hypothesis  
  
The relationship between students' alcohol consumption and their age will be analysed.  
  
In the survey students had to indicate their actual age.  
  
The students' age ranged from 15 to 22 with average age of around 17.

```{r, echo=TRUE} 
summary(alc$age)

```

The boxplot shows that 50% of students who do not consume high amounts of alcohol are between the age of 16 and 17, while 50% of students who consume higher amounts of alcohol are between the ages of 16 and 18 and their overall answer range is wider.  

```{r, echo=TRUE}
g3 <- ggplot(alc, aes(x = high_use, y= age))
g3 + geom_boxplot(aes()) + xlab("High alcohol consuption") + ylab("Age") + ggtitle("Students' age by alcohol consumption")

```


**H4**: Younger students consume more alcohol than older students.

**H4 is declined.**  

